<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PromiseLand-CKMC | Minecraft Portal</title>

  <!-- Tailwind (Play CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { outfit: ["Outfit","ui-sans-serif","system-ui","Segoe UI","Roboto","Arial","sans-serif"] },
          colors: {
            bg0: "#070A12",
            bg1: "#0B1020",
            gold: "#FFD54A",
            mint: "#34D399",
            sky: "#60A5FA"
          },
          boxShadow: {
            soft: "0 18px 60px rgba(0,0,0,.60)",
            lift: "0 18px 38px rgba(0,0,0,.52)",
            glow: "0 0 35px rgba(255,213,74,.18)"
          },
          keyframes: {
            floaty: { "0%,100%": { transform: "translateY(0px)" }, "50%": { transform: "translateY(-8px)" } },
            shimmer: { "0%": { backgroundPosition: "0% 50%" }, "100%": { backgroundPosition: "100% 50%" } },
            pulseSoft: { "0%,100%": { opacity: .35 }, "50%": { opacity: .6 } }
          },
          animation: {
            floaty: "floaty 4.8s ease-in-out infinite",
            shimmer: "shimmer 10s ease-in-out infinite",
            pulseSoft: "pulseSoft 4.6s ease-in-out infinite"
          }
        }
      }
    }
  </script>

  <!-- Extra stylesheets -->
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Optional: animate.css (nice micro-animations) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>

<body class="font-outfit text-white min-h-screen overflow-x-hidden
  bg-[radial-gradient(1100px_700px_at_12%_10%,rgba(255,213,74,.14),transparent_55%),radial-gradient(900px_650px_at_88%_86%,rgba(96,165,250,.14),transparent_55%),linear-gradient(180deg,#070A12,#0B1020)]">

  <!-- Ambient -->
  <div id="ambient" aria-hidden="true" class="pointer-events-none fixed inset-0 -z-10">
    <div class="absolute inset-0 noise"></div>
    <div class="absolute inset-0 tinygrid"></div>
    <div id="spotlight" class="absolute inset-0 spotlight"></div>
    <div class="absolute -top-28 -left-28 w-[520px] h-[520px] rounded-full bg-[rgba(255,213,74,.16)] blur-3xl animate-floaty"></div>
    <div class="absolute -bottom-32 -right-24 w-[620px] h-[620px] rounded-full bg-[rgba(96,165,250,.14)] blur-3xl animate-floaty [animation-delay:1.3s]"></div>
  </div>

  <!-- Hidden audio element (controlled by JS) -->
  <audio id="bgm" loop preload="none">
    <source src="/assets/bgm.mp3" type="audio/mpeg">
    <source src="/assets/bgm.ogg" type="audio/ogg">
  </audio>

  <!-- Topbar -->
  <header class="sticky top-0 z-50 border-b border-white/10 bg-[linear-gradient(180deg,rgba(7,10,18,.92),rgba(7,10,18,.62))] backdrop-blur">
    <div class="mx-auto max-w-6xl px-4 py-3 flex items-center justify-between gap-3">
      <div class="flex items-center gap-3">
        <div class="w-11 h-11 rounded-2xl grid place-items-center border border-white/15 shadow-glow
                    bg-[radial-gradient(14px_14px_at_30%_30%,rgba(255,255,255,.38),transparent_60%),linear-gradient(135deg,rgba(255,213,74,.55),rgba(96,165,250,.40))]">
          <i class="fa-solid fa-cross text-white drop-shadow"></i>
        </div>
        <div class="leading-tight">
          <div class="font-black tracking-wide text-lg" id="brandName">PromiseLand-CKMC</div>
          <div class="text-white/70 -mt-0.5">Minecraft Portal</div>
        </div>

        <div class="hidden md:flex items-center gap-2 ml-2 px-3 py-1.5 rounded-full border border-white/10 bg-white/5">
          <span id="statusDot" class="w-2.5 h-2.5 rounded-full bg-white/30"></span>
          <span class="text-sm font-bold text-white/75" id="statusText">Checking…</span>
        </div>
      </div>

      <nav class="flex items-center gap-2" aria-label="Links">
        <a id="discordLink" href="https://discord.gg/EVeQ3RssqX" target="_blank" rel="noopener"
           class="focus-ring sheen w-11 h-11 rounded-full grid place-items-center border border-white/15 bg-white/5 hover:bg-white/10 hover:-translate-y-0.5 transition shadow-lg"
           title="Discord">
          <i class="fa-brands fa-discord"></i>
        </a>

        <a id="youtubeLink" href="https://www.youtube.com/@SwiflyNetwork" target="_blank" rel="noopener"
           class="focus-ring sheen w-11 h-11 rounded-full grid place-items-center border border-white/15 bg-white/5 hover:bg-white/10 hover:-translate-y-0.5 transition shadow-lg"
           title="YouTube">
          <i class="fa-brands fa-youtube"></i>
        </a>

        <!-- Music toggle -->
        <button id="musicBtn"
          class="focus-ring sheen w-11 h-11 rounded-full grid place-items-center border border-white/15 bg-white/5 hover:bg-white/10 hover:-translate-y-0.5 transition shadow-lg"
          title="Toggle music"
          aria-pressed="false">
          <i id="musicIcon" class="fa-solid fa-music"></i>
        </button>

        <!-- Tiny volume popover -->
        <div class="relative">
          <button id="volumeBtn"
            class="focus-ring sheen w-11 h-11 rounded-full grid place-items-center border border-white/15 bg-white/5 hover:bg-white/10 hover:-translate-y-0.5 transition shadow-lg"
            title="Volume">
            <i class="fa-solid fa-volume-high"></i>
          </button>

          <div id="volumePanel"
               class="hidden absolute right-0 mt-2 w-56 glass-strong rounded-2xl p-3 border border-white/10 shadow-soft">
            <div class="text-xs font-black text-white/70 mb-2">Background Music</div>
            <input id="volumeSlider" type="range" min="0" max="1" step="0.01" value="0.25" class="w-full">
            <div class="mt-2 flex items-center justify-between text-xs text-white/60">
              <span>Quiet</span><span>Loud</span>
            </div>
          </div>
        </div>

        <button id="effectsToggle"
          class="focus-ring sheen w-11 h-11 rounded-full grid place-items-center border border-white/15 bg-white/5 hover:bg-white/10 hover:-translate-y-0.5 transition shadow-lg"
          title="Toggle effects">
          <i class="fa-solid fa-wand-magic-sparkles"></i>
        </button>
      </nav>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 py-7 pb-20">

    <!-- HERO -->
    <section class="grad-border">
      <div class="glass-strong rounded-3xl shadow-soft overflow-hidden p-6 md:p-8 relative">
        <div aria-hidden="true" class="pointer-events-none absolute -inset-px rounded-3xl
             bg-[linear-gradient(90deg,rgba(255,255,255,.10),rgba(255,213,74,.12),rgba(96,165,250,.10),rgba(255,255,255,.10))]
             opacity-30 blur-xl animate-pulseSoft"></div>

        <div class="relative grid lg:grid-cols-5 gap-6 items-start">
          <div class="lg:col-span-3">
            <div class="inline-flex items-center gap-2 px-3 py-2 rounded-full chip text-white/80 font-semibold tracking-wide">
              <span class="w-2 h-2 rounded-full bg-gold shadow-[0_0_18px_rgba(255,213,74,.35)]"></span>
              <i class="fa-solid fa-dove text-gold"></i>
              <span>Chill • Jesus-centered • Community</span>
            </div>

            <h1 class="mt-4 font-black tracking-wide leading-[1.02] text-4xl md:text-5xl lg:text-6xl">
              <span class="text-transparent bg-clip-text bg-gradient-to-r from-[#fff7db] via-[#ffe9a6] to-[#b9dcff]
                           [background-size:200%_200%] animate-shimmer">
                PromiseLand-CKMC
              </span>
            </h1>

            <p class="mt-3 text-white/75 text-base md:text-lg max-w-2xl">
              A chill, Jesus-centered Minecraft community focused on fun, friendship, and faith.
              Join through the portal, add the server, and come hang out.
            </p>

            <div class="mt-6 grid sm:grid-cols-2 gap-3">
              <button id="openPortal"
                class="focus-ring sheen btn2 rounded-2xl px-4 py-3 font-extrabold flex items-center justify-center gap-2 shadow-lift">
                <i class="fa-solid fa-rocket"></i> Launch Portal
              </button>
              <button id="openGuide"
                class="focus-ring sheen btn rounded-2xl px-4 py-3 font-extrabold flex items-center justify-center gap-2 shadow-lift">
                <i class="fa-solid fa-plug"></i> Connection Guide
              </button>
            </div>

            <div class="mt-3 flex flex-wrap gap-3">
              <button id="copyInvite"
                class="focus-ring sheen btn rounded-2xl px-4 py-3 font-extrabold flex items-center gap-2">
                <i class="fa-solid fa-link"></i> Copy Invite Text
              </button>
              <button id="scrollToConnect"
                class="focus-ring sheen btn rounded-2xl px-4 py-3 font-extrabold flex items-center gap-2">
                <i class="fa-solid fa-satellite-dish"></i> Quick Connect
              </button>
            </div>

            <div class="mt-4 text-sm text-white/60">
              Music tip: click the <span class="font-extrabold">music</span> icon to start. Browsers block autoplay audio. :contentReference[oaicite:3]{index=3}
            </div>
          </div>

          <!-- CONNECT PANEL -->
          <aside class="lg:col-span-2">
            <div class="glass rounded-3xl p-5 border border-white/10 liftCard">
              <div class="flex items-center justify-between gap-3">
                <div class="font-black tracking-wide text-lg flex items-center gap-2">
                  <i class="fa-solid fa-satellite-dish text-gold"></i> Connect
                </div>
                <span class="px-3 py-1.5 rounded-full chip font-extrabold">1.8.8</span>
              </div>

              <div class="mt-4 grid gap-3" id="connectSection">

                <div class="glass rounded-2xl p-4 border border-white/10 liftCard">
                  <div class="flex items-center justify-between gap-3">
                    <div class="font-extrabold text-white/85 flex items-center gap-2">
                      <i class="fa-solid fa-globe text-sky"></i> Eagler (WSS)
                    </div>
                    <span class="text-[11px] font-black text-white/70 px-2 py-1 rounded-full chip">Browser</span>
                  </div>
                  <div class="mt-2 flex flex-wrap items-center justify-between gap-3">
                    <span class="mono font-extrabold text-sm md:text-base break-all" id="wssText">wss://promiselandmc.com/</span>
                    <div class="flex gap-2">
                      <button id="copyWSS" class="focus-ring sheen btn rounded-xl px-3 py-2 font-extrabold inline-flex items-center gap-2">
                        <i class="fa-regular fa-copy"></i> Copy
                      </button>
                      <button id="launchDesktop" class="focus-ring sheen btn2 rounded-xl px-3 py-2 font-extrabold inline-flex items-center gap-2">
                        <i class="fa-solid fa-desktop"></i> Desktop
                      </button>
                    </div>
                  </div>
                  <div class="mt-2 text-xs text-white/60">Launch → Multiplayer → Add Server → paste WSS</div>
                </div>

                <div class="glass rounded-2xl p-4 border border-white/10 liftCard">
                  <div class="flex items-center justify-between gap-3">
                    <div class="font-extrabold text-white/85 flex items-center gap-2">
                      <i class="fa-solid fa-server text-gold"></i> Java
                    </div>
                    <span class="text-[11px] font-black text-white/70 px-2 py-1 rounded-full chip">25565</span>
                  </div>
                  <div class="mt-2 flex flex-wrap items-center justify-between gap-3">
                    <span class="mono font-extrabold text-sm md:text-base break-all" id="javaText">promiselandmc.com</span>
                    <button id="copyJava" class="focus-ring sheen btn rounded-xl px-3 py-2 font-extrabold inline-flex items-center gap-2">
                      <i class="fa-regular fa-copy"></i> Copy
                    </button>
                  </div>
                </div>

                <div class="glass rounded-2xl p-4 border border-white/10 liftCard">
                  <div class="flex items-center justify-between gap-3">
                    <div class="font-extrabold text-white/85 flex items-center gap-2">
                      <i class="fa-solid fa-gamepad text-mint"></i> Bedrock
                    </div>
                    <span class="text-[11px] font-black text-white/70 px-2 py-1 rounded-full chip">9888</span>
                  </div>
                  <div class="mt-2 flex flex-wrap items-center justify-between gap-3">
                    <span class="mono font-extrabold text-sm md:text-base break-all" id="bedrockText">mc.promiselandmc.com:9888</span>
                    <button id="copyBedrock" class="focus-ring sheen btn rounded-xl px-3 py-2 font-extrabold inline-flex items-center gap-2">
                      <i class="fa-regular fa-copy"></i> Copy
                    </button>
                  </div>
                </div>

              </div>

              <div class="mt-3 flex gap-2">
                <button id="copyAll" class="focus-ring sheen btn rounded-2xl px-4 py-3 font-extrabold inline-flex items-center gap-2">
                  <i class="fa-solid fa-copy"></i> Copy All
                </button>
                <button id="launchMobile" class="focus-ring sheen btn rounded-2xl px-4 py-3 font-extrabold inline-flex items-center gap-2">
                  <i class="fa-solid fa-mobile-screen-button"></i> Mobile
                </button>
              </div>

            </div>
          </aside>
        </div>
      </div>
    </section>

  </main>

  <!-- Toast -->
  <div id="toast" class="fixed left-1/2 bottom-5 -translate-x-1/2 translate-y-3 opacity-0 pointer-events-none
                        bg-black/80 border border-white/15 text-white px-4 py-2 rounded-full shadow-lg
                        flex items-center gap-2 font-extrabold transition"
       role="status" aria-live="polite">
    <span class="w-2.5 h-2.5 rounded-full bg-gold shadow-[0_0_16px_rgba(255,213,74,.35)]"></span>
    <span id="toastText">Copied!</span>
  </div>

  <script>
    const SERVER = {
      wss: "wss://promiselandmc.com/",
      java: "promiselandmc.com",
      bedrock: "mc.promiselandmc.com:9888",
      desktopPortalPath: "/game.html",
      mobilePortalPath: "/mobile.html",
      healthPath: "/health"
    };

    const $ = (id) => document.getElementById(id);

    // ---- Toast
    const toast = $("toast");
    const toastText = $("toastText");
    let toastTimer = null;
    function showToast(msg){
      toastText.textContent = msg;
      toast.classList.remove("opacity-0", "translate-y-3");
      toast.classList.add("opacity-100", "translate-y-0");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => {
        toast.classList.add("opacity-0", "translate-y-3");
        toast.classList.remove("opacity-100", "translate-y-0");
      }, 1400);
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
      }catch{
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
      }
      showToast("Copied!");
    }

    // ---- Copy buttons
    $("copyWSS").addEventListener("click", () => copyText(SERVER.wss));
    $("copyJava").addEventListener("click", () => copyText(SERVER.java));
    $("copyBedrock").addEventListener("click", () => copyText(SERVER.bedrock));
    $("copyAll").addEventListener("click", () => copyText(
`PromiseLand-CKMC

Eagler (WSS):
${SERVER.wss}

Java:
${SERVER.java}

Bedrock:
${SERVER.bedrock}`
    ));
    $("copyInvite").addEventListener("click", () => copyText(
`PromiseLand-CKMC — Chill, Jesus-centered Minecraft community.

Eagler (WSS): ${SERVER.wss}
Java: ${SERVER.java}
Bedrock: ${SERVER.bedrock}`
    ));

    // ---- Portal launch
    function launch(path){
      localStorage.setItem("game", "true");
      window.location.href = path;
    }
    $("launchDesktop").addEventListener("click", () => launch(SERVER.desktopPortalPath));
    $("launchMobile").addEventListener("click", () => launch(SERVER.mobilePortalPath));
    $("openPortal").addEventListener("click", () => launch(SERVER.desktopPortalPath));

    // ---- Effects toggle
    let fxOn = true;
    $("effectsToggle").addEventListener("click", () => {
      fxOn = !fxOn;
      $("ambient").style.display = fxOn ? "" : "none";
      showToast(fxOn ? "Effects on" : "Effects off");
    });

    // ---- Mouse spotlight
    let raf = null;
    window.addEventListener("mousemove", (e) => {
      if (!fxOn) return;
      if (raf) return;
      raf = requestAnimationFrame(() => {
        raf = null;
        document.documentElement.style.setProperty("--mx", e.clientX + "px");
        document.documentElement.style.setProperty("--my", e.clientY + "px");
      });
    }, { passive: true });

    // ---- Status check (/health)
    async function checkStatus(){
      const dot = $("statusDot");
      const text = $("statusText");
      try{
        const r = await fetch(SERVER.healthPath, { cache: "no-store" });
        if (!r.ok) throw new Error("bad");
        dot.className = "w-2.5 h-2.5 rounded-full bg-emerald-400 shadow-[0_0_18px_rgba(52,211,153,.45)]";
        text.textContent = "Proxy Online";
      }catch{
        dot.className = "w-2.5 h-2.5 rounded-full bg-rose-400 shadow-[0_0_18px_rgba(251,113,133,.35)]";
        text.textContent = "Proxy Offline";
      }
    }
    checkStatus();
    setInterval(checkStatus, 15000);

    // =========================
    // Background Music Controls
    // =========================
    const bgm = $("bgm");
    const musicBtn = $("musicBtn");
    const musicIcon = $("musicIcon");
    const volumeBtn = $("volumeBtn");
    const volumePanel = $("volumePanel");
    const volumeSlider = $("volumeSlider");

    // Persisted settings
    const savedOn = localStorage.getItem("music_on") === "1";
    const savedVol = Number(localStorage.getItem("music_vol") ?? "0.25");
    bgm.volume = isFinite(savedVol) ? Math.min(1, Math.max(0, savedVol)) : 0.25;
    volumeSlider.value = String(bgm.volume);

    function setMusicUI(on){
      musicBtn.setAttribute("aria-pressed", on ? "true" : "false");
      musicIcon.className = on ? "fa-solid fa-music text-[#FFD54A]" : "fa-solid fa-music";
    }

    async function tryPlay(){
      // play() returns a Promise and can reject if autoplay is blocked
      // so we only call it inside user gestures (button clicks). :contentReference[oaicite:4]{index=4}
      try{
        await bgm.play();
        localStorage.setItem("music_on", "1");
        setMusicUI(true);
        showToast("Music on");
      }catch{
        localStorage.setItem("music_on", "0");
        setMusicUI(false);
        showToast("Tap again to enable music");
      }
    }

    function stopMusic(){
      try{ bgm.pause(); }catch{}
      localStorage.setItem("music_on", "0");
      setMusicUI(false);
      showToast("Music off");
    }

    musicBtn.addEventListener("click", () => {
      if (bgm.paused) tryPlay();
      else stopMusic();
    });

    volumeSlider.addEventListener("input", () => {
      bgm.volume = Number(volumeSlider.value);
      localStorage.setItem("music_vol", String(bgm.volume));
    });

    volumeBtn.addEventListener("click", () => {
      volumePanel.classList.toggle("hidden");
    });
    document.addEventListener("click", (e) => {
      if (!volumePanel.contains(e.target) && e.target !== volumeBtn) volumePanel.classList.add("hidden");
    });

    // If user had music enabled previously, we *still* must wait for a gesture to start audio on many browsers.
    setMusicUI(savedOn && !bgm.paused);
  </script>
</body>
</html>
